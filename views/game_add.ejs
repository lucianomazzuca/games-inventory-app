<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/tailwind.css' />
  </head>
  <body>

    <%- include('partials/nav'); %>   

    
    <div class="wrapper flex flex-col items-center">
        <h1 class="font-semibold text-2xl my-4 text-left "><%= title %></h1>
        
        <form action="/games/add" 
            method="POST" 
            enctype="multipart/form-data"
            class="w-full max-w-xl"
            >
            <div class="form-group">
                <label for="title">Title</label>
                <input 
                    type="text" 
                    name="title" 
                    class="input"
                    value=<%= typeof game != 'undefined' ? game.title : '' %>
                >
            </div>

            <div class="form-group">
                <label for="image">Image</label>
                <input 
                    type="file"
                    name="image"
                    value=<%= typeof game != 'undefined' ? game.image : '' %>
                    class="input "
                >
            </div>
            
            <div class="form-group">
                <label for="description">Description</label>
                <textarea  
                    name="description" 
                    id="description" 
                    cols="30" 
                    rows="10" 
                    class="input"
                ><%= typeof game != 'undefined' ? game.description : '' %></textarea>
            </div>
            <div class="form-group">
                <label for="price">Price</label>
                <input 
                    type="text" 
                    name="price"
                    class="input"
                    value=<%= typeof game != 'undefined' ? game.price : '' %>
                >
            </div>
            <div class="form-group">
                <label for="release">Release</label>
                <input 
                    type="text" 
                    name="release"
                    class="input"
                    value=<%= typeof game != 'undefined' ? game.release : '' %>
                >
            </div>
            <div class="form-group">
                <label for="stock">Stock</label>
                <input 
                    type="text" 
                    name="stock"
                    class="input"
                    value=<%= typeof game != 'undefined' ? game.stock : '' %>
                >
            </div>
            <div class="form-group">
                <label for="developer">Developer</label>
                <select name="developer" id="developer" class="input">
                    <% developers.forEach(developer => { %>
                        <!-- When updating game, show current developer selected -->
                        <option 
                            value= <%= developer._id %>
                            <%= (typeof game != 'undefined' && developer._id.toString() === game.developer._id.toString()) ? 'selected' : '' %>  
                        >
                            <%= developer.name %>
                        </option>
                    <% }) %>
                </select>
            </div>
    
            <p class="mb-1">Genre</p>
            <div class="select-group" >
                <% genres.forEach(genre => { %>
                    <!-- When updating game, check categories for the current game -->
                    <input 
                        type="checkbox" 
                        id="<%= genre.name %>" 
                        name="genre" 
                        value="<%= genre._id %>"
                        <% if (typeof game != 'undefined')  {%>  
                            <%= game.genre.includes(genre._id) ? 'checked' : '' %> 
                        <% } %> 
                    >
                    <label for="<%= genre.name %>"><%= genre.name %></label>
                <% }) %>
            </div>
    
            <button type="submit" class="btn bg-green-500 hover:bg-green-600 mt-4">Submit</button>
        </form>
    </div>

  </body>
</html>

